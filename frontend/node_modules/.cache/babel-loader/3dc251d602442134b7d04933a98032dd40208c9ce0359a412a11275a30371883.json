{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Desktop\\\\Interacthub\\\\frontend\\\\src\\\\components\\\\manager\\\\ManagerComms.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport SockJS from 'sockjs-client';\nimport { Client } from '@stomp/stompjs';\nimport { motion } from 'framer-motion';\nimport apiConfig from '../../config/api';\nimport { authHelpers } from '../../config/auth';\nimport LiveAnnouncementComponent from './LiveAnnouncementComponent';\nimport LivePollComponent from './LivePollComponent';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VALID_AUDIENCES = ['ALL', 'HR', 'MANAGER', 'EMPLOYEE', 'ADMIN'];\nconst variants = {\n  hidden: {\n    opacity: 0,\n    y: 20\n  },\n  show: {\n    opacity: 1,\n    y: 0\n  }\n};\nconst ManagerComms = () => {\n  _s();\n  const [globalComms, setGlobalComms] = useState([]);\n  const [globalAnnouncement, setGlobalAnnouncement] = useState({\n    title: '',\n    content: '',\n    type: 'GENERAL'\n  });\n  const [globalPoll, setGlobalPoll] = useState({\n    question: '',\n    options: ['']\n  });\n  const [message, setMessage] = useState(null);\n  const [userLikes, setUserLikes] = useState({}); // Track which announcements user has liked\n\n  const stompRef = useRef(null);\n  const myName = authHelpers.getUserName();\n  useEffect(() => {\n    fetchGlobal();\n    // Use chat service WebSocket for likes/comments, admin service WebSocket for deletions\n    const chatSocket = new SockJS(apiConfig.websocketUrl);\n    const adminSocket = new SockJS(apiConfig.adminWebsocketUrl);\n    const chatClient = new Client({\n      webSocketFactory: () => chatSocket,\n      reconnectDelay: 5000\n    });\n    const adminClient = new Client({\n      webSocketFactory: () => adminSocket,\n      reconnectDelay: 5000\n    });\n\n    // Chat service WebSocket for likes/comments and new items\n    chatClient.onConnect = () => {\n      chatClient.subscribe('/topic/announcements.new', m => {\n        try {\n          const ann = JSON.parse(m.body || '{}');\n          const a = (ann.targetAudience || '').toUpperCase();\n          if (['ALL', 'MANAGER', 'ADMIN'].includes(a)) setGlobalComms(prev => [ann, ...prev]);\n        } catch {}\n      });\n      chatClient.subscribe('/topic/polls.new', m => {\n        try {\n          const poll = JSON.parse(m.body || '{}');\n          const a = (poll.targetAudience || '').toUpperCase();\n          if (['ALL', 'MANAGER', 'ADMIN'].includes(a)) setGlobalComms(prev => [poll, ...prev]);\n        } catch {}\n      });\n\n      // Subscribe to general announcement reactions\n      chatClient.subscribe('/topic/announcements.reactions', msg => {\n        try {\n          const reaction = JSON.parse(msg.body || '{}');\n          if (reaction.type === 'LIKE') {\n            // Update like status for the specific announcement\n            setUserLikes(prev => ({\n              ...prev,\n              [reaction.announcementId]: reaction.liked\n            }));\n          } else if (reaction.type === 'COMMENT') {\n            // Refresh data when new comment is added\n            console.log('Comment reaction received in manager:', reaction);\n            fetchGlobal();\n          }\n        } catch (error) {\n          console.error('Error processing announcement reaction in manager:', error);\n        }\n      });\n    };\n\n    // Admin service WebSocket for deletions\n    adminClient.onConnect = () => {\n      // Subscribe to deletion events\n      adminClient.subscribe('/topic/announcements.deleted', msg => {\n        try {\n          const deletion = JSON.parse(msg.body || '{}');\n          console.log('Announcement deleted in manager:', deletion);\n          // Remove the deleted announcement from the list\n          setGlobalComms(prev => prev.filter(item => !('content' in item) || item.id !== deletion.id));\n        } catch (error) {\n          console.error('Error processing announcement deletion in manager:', error);\n        }\n      });\n      adminClient.subscribe('/topic/polls.deleted', msg => {\n        try {\n          const deletion = JSON.parse(msg.body || '{}');\n          console.log('Poll deleted in manager:', deletion);\n          // Remove the deleted poll from the list\n          setGlobalComms(prev => prev.filter(item => !('question' in item) || item.id !== deletion.id));\n        } catch (error) {\n          console.error('Error processing poll deletion in manager:', error);\n        }\n      });\n    };\n    chatClient.activate();\n    adminClient.activate();\n    stompRef.current = {\n      chat: chatClient,\n      admin: adminClient\n    };\n    return () => {\n      chatClient.deactivate();\n      adminClient.deactivate();\n    };\n  }, []);\n\n  // Subscribe to individual announcement like and comment updates when globalComms change\n  useEffect(() => {\n    if (stompRef.current && stompRef.current.chat && stompRef.current.chat.connected) {\n      globalComms.forEach(item => {\n        if ('content' in item) {\n          // It's an announcement\n          // Subscribe to likes\n          stompRef.current.chat.subscribe(`/topic/announcement.${item.id}.likes`, msg => {\n            const count = parseInt(msg.body) || 0;\n            // Refresh data to get updated like counts\n            fetchGlobal();\n          });\n\n          // Subscribe to comments\n          stompRef.current.chat.subscribe(`/topic/announcement.${item.id}.comments`, msg => {\n            console.log('New comment received for announcement', item.id, ':', msg.body);\n            // Refresh data to get updated comments\n            fetchGlobal();\n          });\n        }\n      });\n    }\n  }, [globalComms]);\n  const fetchGlobal = async () => {\n    try {\n      const [ra, rp] = await Promise.all([axios.get(`${apiConfig.adminService}/announcements/target/ALL`), axios.get(`${apiConfig.adminService}/polls/target/ALL`)]);\n      setGlobalComms([...(ra.data || []), ...(rp.data || [])]);\n\n      // Load user's current like status for all announcements\n      loadUserLikes(ra.data || []);\n    } catch {\n      setMessage({\n        type: 'error',\n        text: 'Could not fetch Admin communications.'\n      });\n    }\n  };\n  const loadUserLikes = async announcements => {\n    const currentUser = authHelpers.getUserName() || 'User';\n    const likes = {};\n    for (const ann of announcements) {\n      try {\n        const base = apiConfig.chatService.replace('/api/chat', '/api/interactions');\n        const response = await fetch(`${base}/announcement/${ann.id}/interactions`);\n        const interactions = await response.json();\n        const userLike = interactions.find(i => i.userName === currentUser && i.type === 'LIKE');\n        likes[ann.id] = !!userLike;\n      } catch (error) {\n        console.error(`Error loading likes for announcement ${ann.id}:`, error);\n        likes[ann.id] = false;\n      }\n    }\n    setUserLikes(likes);\n  };\n  const handleCreateGlobalAnnouncement = async e => {\n    e.preventDefault();\n    try {\n      const payload = {\n        title: globalAnnouncement.title,\n        content: globalAnnouncement.content,\n        type: (globalAnnouncement.type || 'GENERAL').toUpperCase(),\n        targetAudience: 'ALL',\n        createdByName: myName\n      };\n      await axios.post(`${apiConfig.adminService}/announcements`, payload);\n      setMessage({\n        type: 'success',\n        text: 'Announcement posted.'\n      });\n      setGlobalAnnouncement({\n        title: '',\n        content: '',\n        type: 'GENERAL'\n      });\n      fetchGlobal();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      setMessage({\n        type: 'error',\n        text: (error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Failed to post announcement.'\n      });\n    }\n  };\n  const handleCreateGlobalPoll = async e => {\n    e.preventDefault();\n    try {\n      const pollData = {\n        question: globalPoll.question,\n        options: (globalPoll.options || []).filter(o => (o || '').trim() !== ''),\n        targetAudience: 'ALL',\n        createdByName: myName,\n        isActive: true\n      };\n      if (pollData.options.length < 2) {\n        setMessage({\n          type: 'error',\n          text: 'A poll needs at least two options.'\n        });\n        return;\n      }\n      await axios.post(`${apiConfig.adminService}/polls`, pollData);\n      setMessage({\n        type: 'success',\n        text: 'Poll created.'\n      });\n      setGlobalPoll({\n        question: '',\n        options: ['']\n      });\n      fetchGlobal();\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      setMessage({\n        type: 'error',\n        text: (error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || 'Failed to create poll.'\n      });\n    }\n  };\n  const handlePollOptionChange = (index, value) => {\n    const next = [...(globalPoll.options || [])];\n    next[index] = value;\n    setGlobalPoll(p => ({\n      ...p,\n      options: next\n    }));\n  };\n  const deleteAnnouncement = async id => {\n    if (!window.confirm('Are you sure you want to delete this announcement?')) return;\n    try {\n      const userName = authHelpers.getUserName() || 'User';\n      await axios.delete(`${apiConfig.adminService}/announcements/${id}`, {\n        headers: {\n          'X-User-Name': userName\n        }\n      });\n      setMessage({\n        type: 'success',\n        text: 'Announcement deleted successfully.'\n      });\n      fetchGlobal();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setMessage({\n        type: 'error',\n        text: (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || 'Failed to delete announcement'\n      });\n    }\n  };\n  const deletePoll = async id => {\n    if (!window.confirm('Are you sure you want to delete this poll?')) return;\n    try {\n      const userName = authHelpers.getUserName() || 'User';\n      await axios.delete(`${apiConfig.adminService}/polls/${id}`, {\n        headers: {\n          'X-User-Name': userName\n        }\n      });\n      setMessage({\n        type: 'success',\n        text: 'Poll deleted successfully.'\n      });\n      fetchGlobal();\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      setMessage({\n        type: 'error',\n        text: (err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || 'Failed to delete poll'\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    initial: {\n      opacity: 0\n    },\n    animate: {\n      opacity: 1\n    },\n    className: \"space-y-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold text-gray-800\",\n      children: \"Manager Communications\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-6 rounded-xl shadow-md border-l-4 border-emerald-500\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold mb-3\",\n        children: \"Create Global Announcement\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleCreateGlobalAnnouncement,\n        className: \"space-y-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"p-2 border rounded\",\n            placeholder: \"Title\",\n            value: globalAnnouncement.title,\n            onChange: e => setGlobalAnnouncement(p => ({\n              ...p,\n              title: e.target.value\n            })),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"p-2 border rounded\",\n            value: globalAnnouncement.type,\n            onChange: e => setGlobalAnnouncement(p => ({\n              ...p,\n              type: e.target.value\n            })),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"GENERAL\",\n              children: \"GENERAL\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"URGENT\",\n              children: \"URGENT\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 55\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"POLICY\",\n              children: \"POLICY\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"EVENT\",\n              children: \"EVENT\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 53\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"UPDATE\",\n              children: \"UPDATE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 89\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"w-full p-2 border rounded h-24\",\n          placeholder: \"Content\",\n          value: globalAnnouncement.content,\n          onChange: e => setGlobalAnnouncement(p => ({\n            ...p,\n            content: e.target.value\n          })),\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700\",\n            children: \"Post Announcement\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-6 rounded-xl shadow-md border-l-4 border-blue-500\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold mb-3\",\n        children: \"Create Global Poll\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleCreateGlobalPoll,\n        className: \"space-y-3\",\n        onKeyDown: e => {\n          if (e.key === 'Enter') e.preventDefault();\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"w-full p-2 border rounded\",\n          placeholder: \"Poll Question\",\n          value: globalPoll.question,\n          onChange: e => setGlobalPoll(p => ({\n            ...p,\n            question: e.target.value\n          })),\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-medium text-sm\",\n          children: \"Options (Max 4)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), (globalPoll.options || []).slice(0, 4).map((opt, idx) => {\n          var _globalPoll$options, _globalPoll$options2;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"w-full p-2 border rounded\",\n              placeholder: `Option ${idx + 1}`,\n              value: opt,\n              onChange: e => handlePollOptionChange(idx, e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 15\n            }, this), idx === (((_globalPoll$options = globalPoll.options) === null || _globalPoll$options === void 0 ? void 0 : _globalPoll$options.length) || 0) - 1 && (((_globalPoll$options2 = globalPoll.options) === null || _globalPoll$options2 === void 0 ? void 0 : _globalPoll$options2.length) || 0) < 4 && /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"px-2 border rounded\",\n              onClick: () => setGlobalPoll(p => ({\n                ...p,\n                options: [...(p.options || []), '']\n              })),\n              children: \"+\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 17\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 13\n          }, this);\n        }), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\",\n            children: \"Launch Poll\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-semibold text-gray-800 border-b pb-2\",\n      children: \"Live Updates\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n      className: \"space-y-4\",\n      initial: \"hidden\",\n      animate: \"show\",\n      variants: {\n        show: {\n          transition: {\n            staggerChildren: 0.1\n          }\n        }\n      },\n      children: globalComms.length > 0 ? globalComms.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0)).map((item, i) => {\n        var _stompRef$current;\n        return /*#__PURE__*/_jsxDEV(motion.div, {\n          variants: variants,\n          children: 'content' in item ? /*#__PURE__*/_jsxDEV(LiveAnnouncementComponent, {\n            announcement: item,\n            onDelete: deleteAnnouncement,\n            userLikes: userLikes,\n            setUserLikes: setUserLikes,\n            stompClient: (_stompRef$current = stompRef.current) === null || _stompRef$current === void 0 ? void 0 : _stompRef$current.chat\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 13\n          }, this) : 'question' in item ? /*#__PURE__*/_jsxDEV(LivePollComponent, {\n            poll: item,\n            onDelete: deletePoll\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 bg-gray-100 rounded\",\n            children: \"Unsupported item\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this)\n        }, `${'content' in item ? 'ann' : 'poll'}-${item.id || i}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 13\n        }, this);\n      }) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500 p-4 bg-white rounded\",\n        children: \"No communications available.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 16\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(motion.div, {\n      className: `p-3 rounded ${message.type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`,\n      initial: {\n        y: -20,\n        opacity: 0\n      },\n      animate: {\n        y: 0,\n        opacity: 1\n      },\n      children: message.text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 236,\n    columnNumber: 5\n  }, this);\n};\n_s(ManagerComms, \"EXJHXuC0LUpU/TvOtC7iPiqw1jk=\");\n_c = ManagerComms;\nexport default ManagerComms;\nvar _c;\n$RefreshReg$(_c, \"ManagerComms\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","SockJS","Client","motion","apiConfig","authHelpers","LiveAnnouncementComponent","LivePollComponent","jsxDEV","_jsxDEV","VALID_AUDIENCES","variants","hidden","opacity","y","show","ManagerComms","_s","globalComms","setGlobalComms","globalAnnouncement","setGlobalAnnouncement","title","content","type","globalPoll","setGlobalPoll","question","options","message","setMessage","userLikes","setUserLikes","stompRef","myName","getUserName","fetchGlobal","chatSocket","websocketUrl","adminSocket","adminWebsocketUrl","chatClient","webSocketFactory","reconnectDelay","adminClient","onConnect","subscribe","m","ann","JSON","parse","body","a","targetAudience","toUpperCase","includes","prev","poll","msg","reaction","announcementId","liked","console","log","error","deletion","filter","item","id","activate","current","chat","admin","deactivate","connected","forEach","count","parseInt","ra","rp","Promise","all","get","adminService","data","loadUserLikes","text","announcements","currentUser","likes","base","chatService","replace","response","fetch","interactions","json","userLike","find","i","userName","handleCreateGlobalAnnouncement","e","preventDefault","payload","createdByName","post","_error$response","_error$response$data","handleCreateGlobalPoll","pollData","o","trim","isActive","length","_error$response2","_error$response2$data","handlePollOptionChange","index","value","next","p","deleteAnnouncement","window","confirm","delete","headers","err","_err$response","_err$response$data","deletePoll","_err$response2","_err$response2$data","div","initial","animate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","placeholder","onChange","target","required","onKeyDown","key","slice","map","opt","idx","_globalPoll$options","_globalPoll$options2","onClick","transition","staggerChildren","sort","b","Date","createdAt","_stompRef$current","announcement","onDelete","stompClient","_c","$RefreshReg$"],"sources":["C:/Users/HP/Desktop/Interacthub/frontend/src/components/manager/ManagerComms.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport SockJS from 'sockjs-client';\r\nimport { Client } from '@stomp/stompjs';\r\nimport { motion } from 'framer-motion';\r\nimport apiConfig from '../../config/api';\r\nimport { authHelpers } from '../../config/auth';\r\nimport LiveAnnouncementComponent from './LiveAnnouncementComponent';\r\nimport LivePollComponent from './LivePollComponent';\r\n\r\nconst VALID_AUDIENCES = ['ALL', 'HR', 'MANAGER', 'EMPLOYEE', 'ADMIN'];\r\nconst variants = { hidden: { opacity: 0, y: 20 }, show: { opacity: 1, y: 0 } };\r\n\r\nconst ManagerComms = () => {\r\n  const [globalComms, setGlobalComms] = useState([]);\r\n  const [globalAnnouncement, setGlobalAnnouncement] = useState({ title: '', content: '', type: 'GENERAL' });\r\n  const [globalPoll, setGlobalPoll] = useState({ question: '', options: [''] });\r\n  const [message, setMessage] = useState(null);\r\n  const [userLikes, setUserLikes] = useState({}); // Track which announcements user has liked\r\n\r\n  const stompRef = useRef(null);\r\n  const myName = authHelpers.getUserName();\r\n\r\n  useEffect(() => {\r\n    fetchGlobal();\r\n    // Use chat service WebSocket for likes/comments, admin service WebSocket for deletions\r\n    const chatSocket = new SockJS(apiConfig.websocketUrl);\r\n    const adminSocket = new SockJS(apiConfig.adminWebsocketUrl);\r\n    const chatClient = new Client({ webSocketFactory: () => chatSocket, reconnectDelay: 5000 });\r\n    const adminClient = new Client({ webSocketFactory: () => adminSocket, reconnectDelay: 5000 });\r\n    \r\n    // Chat service WebSocket for likes/comments and new items\r\n    chatClient.onConnect = () => {\r\n      chatClient.subscribe('/topic/announcements.new', m => {\r\n        try {\r\n          const ann = JSON.parse(m.body || '{}');\r\n          const a = (ann.targetAudience || '').toUpperCase();\r\n          if (['ALL', 'MANAGER', 'ADMIN'].includes(a)) setGlobalComms(prev => [ann, ...prev]);\r\n        } catch {}\r\n      });\r\n      chatClient.subscribe('/topic/polls.new', m => {\r\n        try {\r\n          const poll = JSON.parse(m.body || '{}');\r\n          const a = (poll.targetAudience || '').toUpperCase();\r\n          if (['ALL', 'MANAGER', 'ADMIN'].includes(a)) setGlobalComms(prev => [poll, ...prev]);\r\n        } catch {}\r\n      });\r\n      \r\n      // Subscribe to general announcement reactions\r\n      chatClient.subscribe('/topic/announcements.reactions', (msg) => {\r\n        try {\r\n          const reaction = JSON.parse(msg.body || '{}');\r\n          if (reaction.type === 'LIKE') {\r\n            // Update like status for the specific announcement\r\n            setUserLikes(prev => ({ ...prev, [reaction.announcementId]: reaction.liked }));\r\n          } else if (reaction.type === 'COMMENT') {\r\n            // Refresh data when new comment is added\r\n            console.log('Comment reaction received in manager:', reaction);\r\n            fetchGlobal();\r\n          }\r\n        } catch (error) {\r\n          console.error('Error processing announcement reaction in manager:', error);\r\n        }\r\n      });\r\n    };\r\n    \r\n    // Admin service WebSocket for deletions\r\n    adminClient.onConnect = () => {\r\n      // Subscribe to deletion events\r\n      adminClient.subscribe('/topic/announcements.deleted', (msg) => {\r\n        try {\r\n          const deletion = JSON.parse(msg.body || '{}');\r\n          console.log('Announcement deleted in manager:', deletion);\r\n          // Remove the deleted announcement from the list\r\n          setGlobalComms(prev => prev.filter(item => !('content' in item) || item.id !== deletion.id));\r\n        } catch (error) {\r\n          console.error('Error processing announcement deletion in manager:', error);\r\n        }\r\n      });\r\n      \r\n      adminClient.subscribe('/topic/polls.deleted', (msg) => {\r\n        try {\r\n          const deletion = JSON.parse(msg.body || '{}');\r\n          console.log('Poll deleted in manager:', deletion);\r\n          // Remove the deleted poll from the list\r\n          setGlobalComms(prev => prev.filter(item => !('question' in item) || item.id !== deletion.id));\r\n        } catch (error) {\r\n          console.error('Error processing poll deletion in manager:', error);\r\n        }\r\n      });\r\n    };\r\n    \r\n    chatClient.activate();\r\n    adminClient.activate();\r\n    stompRef.current = { chat: chatClient, admin: adminClient };\r\n    return () => {\r\n      chatClient.deactivate();\r\n      adminClient.deactivate();\r\n    };\r\n  }, []);\r\n\r\n  // Subscribe to individual announcement like and comment updates when globalComms change\r\n  useEffect(() => {\r\n    if (stompRef.current && stompRef.current.chat && stompRef.current.chat.connected) {\r\n      globalComms.forEach(item => {\r\n        if ('content' in item) { // It's an announcement\r\n          // Subscribe to likes\r\n          stompRef.current.chat.subscribe(`/topic/announcement.${item.id}.likes`, (msg) => {\r\n            const count = parseInt(msg.body) || 0;\r\n            // Refresh data to get updated like counts\r\n            fetchGlobal();\r\n          });\r\n          \r\n          // Subscribe to comments\r\n          stompRef.current.chat.subscribe(`/topic/announcement.${item.id}.comments`, (msg) => {\r\n            console.log('New comment received for announcement', item.id, ':', msg.body);\r\n            // Refresh data to get updated comments\r\n            fetchGlobal();\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }, [globalComms]);\r\n\r\n  const fetchGlobal = async () => {\r\n    try {\r\n      const [ra, rp] = await Promise.all([\r\n        axios.get(`${apiConfig.adminService}/announcements/target/ALL`),\r\n        axios.get(`${apiConfig.adminService}/polls/target/ALL`)\r\n      ]);\r\n      setGlobalComms([...(ra.data || []), ...(rp.data || [])]);\r\n      \r\n      // Load user's current like status for all announcements\r\n      loadUserLikes(ra.data || []);\r\n    } catch {\r\n      setMessage({ type: 'error', text: 'Could not fetch Admin communications.' });\r\n    }\r\n  };\r\n\r\n  const loadUserLikes = async (announcements) => {\r\n    const currentUser = authHelpers.getUserName() || 'User';\r\n    const likes = {};\r\n    \r\n    for (const ann of announcements) {\r\n      try {\r\n        const base = apiConfig.chatService.replace('/api/chat','/api/interactions');\r\n        const response = await fetch(`${base}/announcement/${ann.id}/interactions`);\r\n        const interactions = await response.json();\r\n        const userLike = interactions.find(i => \r\n          i.userName === currentUser && i.type === 'LIKE'\r\n        );\r\n        likes[ann.id] = !!userLike;\r\n      } catch (error) {\r\n        console.error(`Error loading likes for announcement ${ann.id}:`, error);\r\n        likes[ann.id] = false;\r\n      }\r\n    }\r\n    \r\n    setUserLikes(likes);\r\n  };\r\n\r\n  const handleCreateGlobalAnnouncement = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const payload = {\r\n        title: globalAnnouncement.title,\r\n        content: globalAnnouncement.content,\r\n        type: (globalAnnouncement.type || 'GENERAL').toUpperCase(),\r\n        targetAudience: 'ALL',\r\n        createdByName: myName\r\n      };\r\n      await axios.post(`${apiConfig.adminService}/announcements`, payload);\r\n      setMessage({ type: 'success', text: 'Announcement posted.' });\r\n      setGlobalAnnouncement({ title: '', content: '', type: 'GENERAL' });\r\n      fetchGlobal();\r\n    } catch (error) {\r\n      setMessage({ type: 'error', text: error?.response?.data?.error || 'Failed to post announcement.' });\r\n    }\r\n  };\r\n\r\n  const handleCreateGlobalPoll = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const pollData = {\r\n        question: globalPoll.question,\r\n        options: (globalPoll.options || []).filter(o => (o || '').trim() !== ''),\r\n        targetAudience: 'ALL',\r\n        createdByName: myName,\r\n        isActive: true\r\n      };\r\n      if (pollData.options.length < 2) { setMessage({ type: 'error', text: 'A poll needs at least two options.' }); return; }\r\n      await axios.post(`${apiConfig.adminService}/polls`, pollData);\r\n      setMessage({ type: 'success', text: 'Poll created.' });\r\n      setGlobalPoll({ question: '', options: [''] });\r\n      fetchGlobal();\r\n    } catch (error) {\r\n      setMessage({ type: 'error', text: error?.response?.data?.error || 'Failed to create poll.' });\r\n    }\r\n  };\r\n\r\n  const handlePollOptionChange = (index, value) => {\r\n    const next = [...(globalPoll.options || [])];\r\n    next[index] = value;\r\n    setGlobalPoll(p => ({ ...p, options: next }));\r\n  };\r\n\r\n  const deleteAnnouncement = async (id) => {\r\n    if (!window.confirm('Are you sure you want to delete this announcement?')) return;\r\n    try {\r\n      const userName = authHelpers.getUserName() || 'User';\r\n      await axios.delete(`${apiConfig.adminService}/announcements/${id}`, {\r\n        headers: { 'X-User-Name': userName }\r\n      });\r\n      setMessage({ type: 'success', text: 'Announcement deleted successfully.' });\r\n      fetchGlobal();\r\n    } catch (err) {\r\n      setMessage({ type: 'error', text: err?.response?.data?.error || 'Failed to delete announcement' });\r\n    }\r\n  };\r\n\r\n  const deletePoll = async (id) => {\r\n    if (!window.confirm('Are you sure you want to delete this poll?')) return;\r\n    try {\r\n      const userName = authHelpers.getUserName() || 'User';\r\n      await axios.delete(`${apiConfig.adminService}/polls/${id}`, {\r\n        headers: { 'X-User-Name': userName }\r\n      });\r\n      setMessage({ type: 'success', text: 'Poll deleted successfully.' });\r\n      fetchGlobal();\r\n    } catch (err) {\r\n      setMessage({ type: 'error', text: err?.response?.data?.error || 'Failed to delete poll' });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"space-y-8\">\r\n      <h1 className=\"text-3xl font-bold text-gray-800\">Manager Communications</h1>\r\n\r\n      <div className=\"bg-white p-6 rounded-xl shadow-md border-l-4 border-emerald-500\">\r\n        <h2 className=\"text-xl font-semibold mb-3\">Create Global Announcement</h2>\r\n        <form onSubmit={handleCreateGlobalAnnouncement} className=\"space-y-3\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n            <input className=\"p-2 border rounded\" placeholder=\"Title\" value={globalAnnouncement.title} onChange={e => setGlobalAnnouncement(p => ({ ...p, title: e.target.value }))} required />\r\n            <select className=\"p-2 border rounded\" value={globalAnnouncement.type} onChange={e => setGlobalAnnouncement(p => ({ ...p, type: e.target.value }))}>\r\n              <option value=\"GENERAL\">GENERAL</option><option value=\"URGENT\">URGENT</option>\r\n              <option value=\"POLICY\">POLICY</option><option value=\"EVENT\">EVENT</option><option value=\"UPDATE\">UPDATE</option>\r\n            </select>\r\n          </div>\r\n          <textarea className=\"w-full p-2 border rounded h-24\" placeholder=\"Content\" value={globalAnnouncement.content} onChange={e => setGlobalAnnouncement(p => ({ ...p, content: e.target.value }))} required />\r\n          <div className=\"flex justify-end\"><button type=\"submit\" className=\"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700\">Post Announcement</button></div>\r\n        </form>\r\n      </div>\r\n\r\n      <div className=\"bg-white p-6 rounded-xl shadow-md border-l-4 border-blue-500\">\r\n        <h2 className=\"text-xl font-semibold mb-3\">Create Global Poll</h2>\r\n        <form onSubmit={handleCreateGlobalPoll} className=\"space-y-3\" onKeyDown={(e) => { if (e.key === 'Enter') e.preventDefault(); }}>\r\n          <input className=\"w-full p-2 border rounded\" placeholder=\"Poll Question\" value={globalPoll.question} onChange={e => setGlobalPoll(p => ({ ...p, question: e.target.value }))} required />\r\n          <h3 className=\"font-medium text-sm\">Options (Max 4)</h3>\r\n          {(globalPoll.options || []).slice(0, 4).map((opt, idx) => (\r\n            <div key={idx} className=\"flex gap-2\">\r\n              <input className=\"w-full p-2 border rounded\" placeholder={`Option ${idx + 1}`} value={opt} onChange={e => handlePollOptionChange(idx, e.target.value)} />\r\n              {idx === (globalPoll.options?.length || 0) - 1 && (globalPoll.options?.length || 0) < 4 && (\r\n                <button type=\"button\" className=\"px-2 border rounded\" onClick={() => setGlobalPoll(p => ({ ...p, options: [...(p.options || []), ''] }))}>+</button>\r\n              )}\r\n            </div>\r\n          ))}\r\n          <div className=\"flex justify-end\"><button type=\"submit\" className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\">Launch Poll</button></div>\r\n        </form>\r\n      </div>\r\n\r\n      <h2 className=\"text-2xl font-semibold text-gray-800 border-b pb-2\">Live Updates</h2>\r\n      <motion.div className=\"space-y-4\" initial=\"hidden\" animate=\"show\" variants={{ show: { transition: { staggerChildren: 0.1 } } }}>\r\n        {globalComms.length > 0 ? globalComms\r\n          .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0))\r\n          .map((item, i) => (\r\n            <motion.div key={`${'content' in item ? 'ann' : 'poll'}-${item.id || i}`} variants={variants}>\r\n        {'content' in item\r\n          ? <LiveAnnouncementComponent announcement={item} onDelete={deleteAnnouncement} userLikes={userLikes} setUserLikes={setUserLikes} stompClient={stompRef.current?.chat} />\r\n          : 'question' in item\r\n            ? <LivePollComponent poll={item} onDelete={deletePoll} />\r\n            : <div className=\"p-4 bg-gray-100 rounded\">Unsupported item</div>}\r\n            </motion.div>\r\n          )) : <p className=\"text-gray-500 p-4 bg-white rounded\">No communications available.</p>}\r\n      </motion.div>\r\n\r\n      {message && (\r\n        <motion.div className={`p-3 rounded ${message.type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`} initial={{ y: -20, opacity: 0 }} animate={{ y: 0, opacity: 1 }}>\r\n          {message.text}\r\n        </motion.div>\r\n      )}\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default ManagerComms;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}